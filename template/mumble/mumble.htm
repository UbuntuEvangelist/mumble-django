{% extends "index.htm" %}
{% block headtags %}
  <meta http-equiv="refresh" content="30" />
{% endblock %}
{% block Headline %}
  {{ ServerObject.rootName }}
{% endblock %}
{% block LeftColumn %}
  {% include "mumble/content.htm" %}
{% endblock %}
{% block Content %}
  {% if user.is_authenticated %}
    <div id="mumble_registration">
      <h2>Server registration</h2>
      <form action="" method="post">
        {% if Registered %}
          You are registered on this server.<br />
        {% else %}
          You do not have an account on this server.<br />
        {% endif %}
        <table>
          {{ RegForm }}
        </table>
        <input type="hidden" name="mode" value="reg" />
        <input type="submit" />
      </form>
    </div>
  {% else %}
    <p>You need to be <a href="/accounts/login">logged in</a> to be able to register an account.</p>
  {% endif %}
  
  {% if CurrentUserIsAdmin %}
    <div id="mumble_admin">
      <h2>Server administration</h2>
      <form action="" method="post">
        <table>
          {{ AdminForm }}
        </table>
        <input type="hidden" name="mode" value="admin" />
        <input type="submit" />
      </form>
    </div>
    <noscript>
      By the way, if you had enabled JavaScript, you could see a nifty Tab bar here :)
    </noscript>
  {% endif %}
  
{% endblock %}

{% block HeadTag %}
  {% if CurrentUserIsAdmin %}
    <script type="text/javascript">
	Ext.onReady( function(){
		Ext.get( 'mumble_registration' ).addClass( 'x-hide-display' );
		Ext.get( 'mumble_admin' ).addClass( 'x-hide-display' );
		
		var cardpanel = new Ext.Panel({
			renderTo:   'col3_content',
			layout:     'card',
			height:     400,
			activeItem: 0,
			border:     false,
			items:      [ {
				xtype:     'tabpanel',
				defaults:  { autoheight: true },
				activeTab: {{ DisplayTab }},
				items: [
					{ contentEl: 'mumble_registration', title: 'Registration'   },
					{ contentEl: 'mumble_admin',        title: 'Administration' },
					]
				} ],
			});
		
		} );
    </script>
  {% endif %}
{% endblock %}
